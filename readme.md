# maximaster/tools.twig

Данная библиотека позволяет использовать twig шаблоны в компонентах 1С Битрикс. Обрабатываются файлы, имеющие расширение .twig. Если создать в директории шаблона компонента файл template.twig, то именно он будет использоваться при генерации шаблона.
К сожалению, ядро битрикса так устроено, что при наличии двух файлов .php и .twig, будет использовать только .php, поэтому для использования twig шаблона нужно позаботиться о том, чтобы php шаблон отсутствовал.

## Наследование шаблонов

Чтобы воспользоваться наследованием шаблонов, можно писать в extends абсолютный путь до шаблона. 
Для упрощения наследования в библиотеке присутсвует загрузчик, который позволяет по короткому имени шаблона получить к нему доступ. Синтаксис простой:

vendor:component_name[:template[:specific_template_file]]

Здесь
* **vendor** - это пространство имен разработчика, например bitrix или maximaster
* **component_name** - имя компонента, шаблон которого наследуется
* **template** - имя шаблона, который нужно унаследовать. Необязательный, по-умолчанию .default
* **specific_template_file** - конкретный файл шаблона (без расширения). Необязательный, по-умолчанию template

Например, вы хотите унаследовать шаблон new-year компонента maximaster:product. Для этого в шаблоне twig нужно написать 

```twig
{% extends "maximaster:product:new-year" %}
```

## Управление настройками

Библиотека конфигурируется с помощью файла /bitrix/.settings.php. Нужно завести в этом файле опцию maximaster, и оперировать значением tools->twig. Ниже описаны все возможные конфиги с их дефолтными значениями:

```php

//...
'maximaster' => array(
    'value' => array(
        'tools' => array(
            'twig' => array(
                array(
                    // Режим отладки выключен
                    'debug' => false,
                    
                    //Кодировка соответствует кодировке продукта
                    'charset' => SITE_CHARSET,
                    
                    //кеш хранится в уникальной директории
                    'cache' => $_SERVER['DOCUMENT_ROOT'] . '/bitrix/cache/maximaster/tools.twig',
                    
                    //Автообновление включается только в момент очистки кеша
                    'auto_reload' => isset( $_GET[ 'clear_cache' ] ) && strtoupper($_GET[ 'clear_cache' ]) == 'Y',
                    
                    //Автоэскейп отключен, т.к. битрикс по-умолчанию его сам делает
                    'autoescape' => false,
                )
            )
        )
    )
)
//...

```
При выборе значений для конфигов нужно опираться на [документацию twig по настройкам Twig_Environment](http://twig.sensiolabs.org/doc/api.html#environment-options) 